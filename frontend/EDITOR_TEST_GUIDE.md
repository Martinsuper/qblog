# 文章编辑页面测试指南

## 访问地址
- 写文章页面：http://localhost:3001/admin/create
- 文章管理页面：http://localhost:3001/admin/articles
- 后台首页：http://localhost:3001/admin/dashboard

## 服务状态检查

### ✅ 前端服务
- 地址：http://localhost:3001
- 状态：已运行

### ✅ 后端服务
- 地址：http://localhost:8080
- 状态：已运行（H2 内存数据库）

## 快速测试（无需后端）

由于后端使用 H2 内存数据库，重启后数据会丢失。你可以先测试前端功能：

### 1. 打开编辑页面
访问 http://localhost:3001/admin/create

### 2. 如果提示未登录
打开浏览器控制台（F12），执行以下代码模拟登录：
```javascript
localStorage.setItem('token', 'test-token-12345');
localStorage.setItem('userInfo', JSON.stringify({
  id: 1,
  username: 'admin',
  nickname: '管理员',
  role: 1,
  avatar: ''
}));
location.reload();
```

### 3. 测试前端功能
即使没有后端数据，你也可以测试：
- ✅ 页面布局显示
- ✅ 标题输入框
- ✅ 分类/标签下拉框（可能为空）
- ✅ 封面上传区域（UI）
- ✅ 摘要输入框
- ✅ Markdown 编辑器
- ✅ 工具栏按钮（插入 Markdown 语法）
- ✅ 预览功能
- ✅ 字数统计

## 完整功能测试（需要后端数据）

### 1. 初始化数据库
访问 http://localhost:8080/api/h2-console 打开 H2 控制台

JDBC URL: `jdbc:h2:mem:qblog;MODE=MySQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE`

执行以下 SQL 插入测试数据：
```sql
-- 插入测试分类
INSERT INTO category (name, description, sort_order, create_time) VALUES
('技术', '技术文章分类', 1, NOW()),
('生活', '生活随笔', 2, NOW()),
('学习', '学习笔记', 3, NOW());

-- 插入测试标签
INSERT INTO tag (name, create_time) VALUES
('Java'),
('Vue'),
('Spring Boot'),
('前端'),
('后端');
```

### 2. 登录
如果还没有登录，访问登录页面或直接使用上面的控制台代码设置 token。

### 3. 测试完整流程
1. 填写文章标题
2. 选择分类
3. 添加标签
4. 上传封面（可选）
5. 填写摘要
6. 使用 Markdown 编辑器编写内容
7. 点击预览查看效果
8. 保存草稿或发布文章

## 功能测试清单

### ✅ 基础功能
- [ ] 页面正常加载，无控制台错误
- [ ] 侧边栏菜单正常显示
- [ ] "写文章" 菜单可点击并跳转
- [ ] 页面标题显示正确（写文章/编辑文章）

### ✅ 表单输入
- [ ] 文章标题输入框可正常输入
- [ ] 标题字数限制 200 字，右上角显示字数
- [ ] 分类下拉框可选择
- [ ] 标签下拉框可多选，支持输入创建
- [ ] 封面图片可上传，上传后显示预览
- [ ] 摘要输入框可输入，限制 500 字

### ✅ Markdown 编辑器
- [ ] 编辑器区域可正常输入
- [ ] 工具栏按钮功能正常：
  - [ ] H - 插入标题 (# )
  - [ ] B - 插入加粗 (**文本**)
  - [ ] </> - 插入行内代码 (`代码`)
  - [ ] • - 插入列表 (- 列表项)
  - [ ] 🔗 - 插入链接 ([文本](url))
  - [ ] 🖼️ - 插入图片 (![描述](url))
- [ ] 点击工具栏按钮后光标位置正确

### ✅ 预览功能
- [ ] 点击"预览"按钮显示预览区域
- [ ] 预览区域显示 Markdown 渲染结果
- [ ] 再次点击"预览"按钮隐藏预览
- [ ] 编辑器滚动时预览区域同步滚动（如果已实现）

### ✅ 字数统计
- [ ] 底部显示实时字数统计
- [ ] 字数计算准确（排除空格）

### ✅ 保存功能
- [ ] 点击"存草稿"按钮保存成功
- [ ] 保存成功后显示提示消息
- [ ] 草稿状态正确（status = 0）

### ✅ 发布功能
- [ ] 标题为空时提示警告
- [ ] 内容为空时提示警告
- [ ] 点击"发布文章"按钮发布成功
- [ ] 发布成功后跳转到文章管理页
- [ ] 发布状态正确（status = 1）

### ✅ 响应式
- [ ] 窗口缩放时布局正常
- [ ] 移动端模式下方表单区换行显示

## 测试 Markdown 内容

复制以下内容到编辑器测试：

```markdown
# 测试文章标题

这是一篇测试文章，用于验证编辑器功能。

## 功能列表

- [x] 标题渲染
- [x] **加粗文本**
- [x] `行内代码`
- [x] 列表项

## 代码示例

```javascript
console.log('Hello, World!')
```

## 引用

> 这是一段引用文本

## 链接

[点击这里](https://example.com) 访问示例网站
```

## 常见问题排查

### 问题 1: 页面空白或无法加载
**检查**: 打开浏览器控制台查看错误信息
**解决**: 确保前端服务运行在 http://localhost:3001

### 问题 2: 点击菜单无反应
**原因**: 路由守卫拦截
**解决**: 在控制台执行登录代码后刷新页面

### 问题 3: 图标不显示
**原因**: 引入了不存在的图标
**解决**: 检查控制台错误，确认图标名称正确

### 问题 4: 后端 API 404
**原因**: 后端服务未启动或路径错误
**解决**: 
1. 确认后端运行在 http://localhost:8080
2. 检查 API 路径是否为 /api/v1/xxx

### 问题 5: 数据库为空
**原因**: H2 内存数据库重启后数据丢失
**解决**: 重新执行 SQL 初始化脚本

## 浏览器控制台测试代码

```javascript
// 检查登录状态
console.log('Token:', localStorage.getItem('token'));
console.log('用户信息:', JSON.parse(localStorage.getItem('userInfo') || '{}'));

// 测试 Markdown 渲染（如果页面已加载 markdown-it）
const md = window.markdownit?.() || null;
if (md) {
  console.log(md.render('# 测试\n\n**加粗**'));
}
```
