import{q as m,h as s,k as u}from"./index-BOupgZvc.js";import{r as n}from"./request-sz1W-oIh.js";function I(t){return n({url:"/auth/login",method:"post",data:t})}function d(t){return n({url:"/auth/register",method:"post",data:t})}function S(){return n({url:"/auth/me",method:"get"})}const p=m("user",()=>{const t=s(localStorage.getItem("token")||""),r=s(JSON.parse(localStorage.getItem("userInfo")||"null")),l=u(()=>!!t.value),c=u(()=>{var e;return((e=r.value)==null?void 0:e.role)===1});async function i(e){const o=await I(e);return t.value=o.data,localStorage.setItem("token",o.data),await a(),o}async function g(e){return await d(e)}async function a(){try{const e=await S();r.value=e.data,localStorage.setItem("userInfo",JSON.stringify(e.data))}catch(e){console.error("获取用户信息失败:",e)}}function f(){t.value="",r.value=null,localStorage.removeItem("token"),localStorage.removeItem("userInfo")}return{token:t,userInfo:r,isLoggedIn:l,isAdmin:c,userLogin:i,userRegister:g,fetchUserInfo:a,userLogout:f}});export{p as u};
