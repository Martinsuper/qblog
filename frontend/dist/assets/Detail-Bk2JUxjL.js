import{_ as q,o as G,a as l,c as m,d as t,w as o,g as p,E as d,h as g,i as n,j as J,b as a,t as c,e as r,f as C,F as K,r as O,k as P}from"./index-BOupgZvc.js";import{M as Q}from"./index-_Dy2zPzC.js";import{b as W,l as X}from"./article-DBlYbpKZ.js";import"./request-sz1W-oIh.js";const Y={class:"article-detail-page"},Z={key:0,class:"article-content"},$={class:"article-header"},ee={class:"article-title"},te={class:"article-meta"},ae={class:"author-info"},oe={class:"author-name"},ne={class:"meta-items"},se={class:"meta-item"},le={class:"meta-item"},ce={class:"meta-item"},re={class:"meta-item"},ie={key:0,class:"article-cover"},ue=["src"],de=["innerHTML"],_e={key:1,class:"article-tags"},me={class:"article-actions"},pe={class:"comment-title"},ve={class:"comment-editor"},he={class:"comment-list"},fe={__name:"Detail",setup(ke){const D=J(),w=new Q({html:!0,linkify:!0,typographer:!0,highlight:function(s,i){return'<pre class="hljs"><code>'+w.utils.escapeHtml(s)+"</code></pre>"}}),e=g(null),f=g(""),k=g(0),F=P(()=>{var s;return(s=e.value)!=null&&s.content?w.render(e.value.content):""}),M=async()=>{try{const s=await W(D.params.id);e.value=s.data,k.value=s.data.commentCount||0,console.log("文章数据:",e.value)}catch(s){console.error("获取文章失败:",s),d.error("获取文章失败")}},A=async()=>{try{await X(e.value.id),e.value.likeCount++,d.success("点赞成功")}catch(s){console.error("点赞失败:",s)}},B=()=>{d.info("收藏功能开发中...")},I=()=>{d.info("分享功能开发中...")},L=()=>{if(!f.value.trim()){d.warning("请输入评论内容");return}d.info("评论功能开发中...")};return G(()=>{M()}),(s,i)=>{const N=n("el-avatar"),T=n("Calendar"),u=n("el-icon"),E=n("View"),y=n("Star"),H=n("ChatDotRound"),R=n("el-tag"),v=n("el-button"),j=n("StarFilled"),z=n("Share"),b=n("el-card"),U=n("el-input"),V=n("el-empty");return l(),m("div",Y,[e.value?(l(),m("article",Z,[t(b,null,{default:o(()=>{var h,x;return[a("div",$,[a("h1",ee,c(e.value.title),1),a("div",te,[a("div",ae,[t(N,{size:32,src:(h=e.value.author)==null?void 0:h.avatar},{default:o(()=>{var _,S;return[r(c((S=(_=e.value.author)==null?void 0:_.nickname)==null?void 0:S.charAt(0)),1)]}),_:1},8,["src"]),a("span",oe,c(((x=e.value.author)==null?void 0:x.nickname)||"管理员"),1)]),a("div",ne,[a("span",se,[t(u,null,{default:o(()=>[t(T)]),_:1}),r(" "+c(e.value.publishTime),1)]),a("span",le,[t(u,null,{default:o(()=>[t(E)]),_:1}),r(" "+c(e.value.viewCount),1)]),a("span",ce,[t(u,null,{default:o(()=>[t(y)]),_:1}),r(" "+c(e.value.likeCount),1)]),a("span",re,[t(u,null,{default:o(()=>[t(H)]),_:1}),r(" "+c(e.value.commentCount),1)])])])]),e.value.coverImage?(l(),m("div",ie,[a("img",{src:e.value.coverImage,alt:"封面图"},null,8,ue)])):C("",!0),a("div",{class:"article-body markdown-body",innerHTML:F.value},null,8,de),e.value.tags&&e.value.tags.length>0?(l(),m("div",_e,[(l(!0),m(K,null,O(e.value.tags,_=>(l(),p(R,{key:_.id,size:"small",style:{"margin-right":"10px","margin-bottom":"10px"}},{default:o(()=>[r(c(_.name),1)]),_:2},1024))),128))])):C("",!0),a("div",me,[t(v,{type:"primary",onClick:A},{default:o(()=>[t(u,null,{default:o(()=>[t(y)]),_:1}),r(" 点赞 ("+c(e.value.likeCount)+") ",1)]),_:1}),t(v,{onClick:B},{default:o(()=>[t(u,null,{default:o(()=>[e.value.isFavorited?(l(),p(j,{key:0})):(l(),p(y,{key:1}))]),_:1}),i[1]||(i[1]=r(" 收藏 ",-1))]),_:1}),t(v,{onClick:I},{default:o(()=>[t(u,null,{default:o(()=>[t(z)]),_:1}),i[2]||(i[2]=r(" 分享 ",-1))]),_:1})])]}),_:1}),t(b,{class:"comment-section"},{default:o(()=>[a("h3",pe,"评论 ("+c(k.value)+")",1),a("div",ve,[t(U,{modelValue:f.value,"onUpdate:modelValue":i[0]||(i[0]=h=>f.value=h),type:"textarea",rows:4,placeholder:"写下你的评论..."},null,8,["modelValue"]),t(v,{type:"primary",class:"mt-3",onClick:L},{default:o(()=>[...i[3]||(i[3]=[r(" 发表评论 ",-1)])]),_:1})]),a("div",he,[k.value===0?(l(),p(V,{key:0,description:"暂无评论"})):C("",!0)])]),_:1})])):(l(),p(V,{key:1,description:"文章不存在"}))])}}},be=q(fe,[["__scopeId","data-v-45ef7150"]]);export{be as default};
