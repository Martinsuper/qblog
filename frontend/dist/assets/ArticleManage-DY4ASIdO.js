import{g as j,d as F}from"./article-DBlYbpKZ.js";import{g as L}from"./category-DCVvt8l0.js";import{_ as N,o as R,a as m,c as C,b as v,d as t,w as o,s as q,g as h,i as n,v as G,h as i,m as H,e as d,F as J,r as K,t as O,x as Q,E as W}from"./index-BOupgZvc.js";import"./request-sz1W-oIh.js";const X={class:"card p-6"},Y={class:"flex items-center justify-between mb-5"},Z={__name:"ArticleManage",setup(ee){const _=i(!1),y=i([]),b=i([]),w=i(0),p=i(1),g=i(10),s=H({keyword:"",categoryId:null}),u=async()=>{_.value=!0;try{const a=await j({page:p.value,size:g.value,...s});y.value=a.data.records||[],w.value=a.data.total||0}catch(a){console.error("获取文章列表失败:",a)}finally{_.value=!1}},x=async()=>{try{const a=await L();b.value=a.data||[]}catch(a){console.error("获取分类失败:",a)}},k=()=>{p.value=1,u()},V=()=>{s.keyword="",s.categoryId=null,k()},z=a=>{Q.confirm("确定要删除这篇文章吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await F(a),W.success("删除成功"),u()}catch(e){console.error("删除失败:",e)}})};return R(()=>{u(),x()}),(a,e)=>{const B=n("Plus"),D=n("el-icon"),c=n("el-button"),I=n("el-input"),f=n("el-form-item"),$=n("el-option"),A=n("el-select"),M=n("el-form"),r=n("el-table-column"),S=n("el-tag"),E=n("el-table"),P=n("el-pagination"),T=G("loading");return m(),C("div",null,[v("div",X,[v("div",Y,[e[6]||(e[6]=v("h3",{class:"text-lg font-semibold",style:{color:"var(--text-primary)"}},"文章管理",-1)),t(c,{type:"primary",onClick:e[0]||(e[0]=l=>a.$router.push("/admin/create"))},{default:o(()=>[t(D,null,{default:o(()=>[t(B)]),_:1}),e[5]||(e[5]=d(" 写文章 ",-1))]),_:1})]),t(M,{inline:!0,model:s,class:"mb-5"},{default:o(()=>[t(f,{label:"关键词"},{default:o(()=>[t(I,{modelValue:s.keyword,"onUpdate:modelValue":e[1]||(e[1]=l=>s.keyword=l),placeholder:"搜索文章标题",clearable:""},null,8,["modelValue"])]),_:1}),t(f,{label:"分类"},{default:o(()=>[t(A,{modelValue:s.categoryId,"onUpdate:modelValue":e[2]||(e[2]=l=>s.categoryId=l),placeholder:"全部分类",clearable:""},{default:o(()=>[(m(!0),C(J,null,K(b.value,l=>(m(),h($,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:o(()=>[t(c,{type:"primary",onClick:k},{default:o(()=>[...e[7]||(e[7]=[d("搜索",-1)])]),_:1}),t(c,{onClick:V},{default:o(()=>[...e[8]||(e[8]=[d("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),q((m(),h(E,{data:y.value,style:{width:"100%"}},{default:o(()=>[t(r,{prop:"id",label:"ID",width:"80"}),t(r,{prop:"title",label:"标题","min-width":"200","show-overflow-tooltip":""}),t(r,{prop:"category",label:"分类",width:"100"}),t(r,{prop:"viewCount",label:"浏览",width:"80"}),t(r,{prop:"likeCount",label:"点赞",width:"80"}),t(r,{prop:"commentCount",label:"评论",width:"80"}),t(r,{prop:"status",label:"状态",width:"80"},{default:o(({row:l})=>[t(S,{type:l.status===1?"success":"info"},{default:o(()=>[d(O(l.status===1?"已发布":"草稿"),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"createTime",label:"创建时间",width:"160"}),t(r,{label:"操作",width:"180",fixed:"right"},{default:o(({row:l})=>[t(c,{link:"",type:"primary",onClick:U=>a.$router.push(`/admin/create?id=${l.id}`)},{default:o(()=>[...e[9]||(e[9]=[d(" 编辑 ",-1)])]),_:1},8,["onClick"]),t(c,{link:"",type:"danger",onClick:U=>z(l.id)},{default:o(()=>[...e[10]||(e[10]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[T,_.value]]),t(P,{"current-page":p.value,"onUpdate:currentPage":e[3]||(e[3]=l=>p.value=l),"page-size":g.value,"onUpdate:pageSize":e[4]||(e[4]=l=>g.value=l),total:w.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",class:"flex justify-end mt-5",onCurrentChange:u,onSizeChange:u},null,8,["current-page","page-size","total"])])])}}},ne=N(Z,[["__scopeId","data-v-5fc20e83"]]);export{ne as default};
